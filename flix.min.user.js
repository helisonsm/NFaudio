// ==UserScript==
// @name        Flix
// @version     1.0.4
// @namespace   @XOR
// @description User script para facilitar download de legendas e Ã¡udios na(o) Netflix
// @author      XOR
// @include     https://www.netflix.com/*
// @icon        data:image/png;base64,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
// @grant       none
// @homepageURL https://gist.github.com/xor10/8f65c1e66a34386e1131f8c28ff6bf64
// @downloadURL https://gist.github.com/xor10/8f65c1e66a34386e1131f8c28ff6bf64/raw/flix.min.user.js
// @updateURL   https://gist.github.com/xor10/8f65c1e66a34386e1131f8c28ff6bf64/raw/flix.min.user.js
// @run-at      document-start
// ==/UserScript==
/* jshint ignore:start */
'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,l){a!=Array.prototype&&a!=Object.prototype&&(a[f]=l.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var f=0;return $jscomp.iteratorPrototype(function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var f=a[Symbol.iterator];return f?f.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,f,l,n){if(f){l=$jscomp.global;a=a.split(".");for(n=0;n<a.length-1;n++){var e=a[n];e in l||(l[e]={});l=l[e]}a=a[a.length-1];n=l[a];f=f(n);f!=n&&null!=f&&$jscomp.defineProperty(l,a,{configurable:!0,writable:!0,value:f})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function f(){this.batch_=null}function l(c){return c instanceof e?c:new e(function(a,e){a(c)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;f.prototype.asyncExecute=function(c){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(c);return this};f.prototype.asyncExecuteBatch_=function(){var c=this;this.asyncExecuteFunction(function(){c.executeBatch_()})};var n=window.setTimeout;f.prototype.asyncExecuteFunction=function(c){n(c,
0)};f.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var c=this.batch_;this.batch_=[];for(var a=0;a<c.length;++a){var e=c[a];delete c[a];try{e()}catch(v){this.asyncThrow_(v)}}}this.batch_=null};f.prototype.asyncThrow_=function(c){this.asyncExecuteFunction(function(){throw c;})};var e=function(c){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var a=this.createResolveAndReject_();try{c(a.resolve,a.reject)}catch(C){a.reject(C)}};e.prototype.createResolveAndReject_=
function(){function c(c){return function(f){e||(e=!0,c.call(a,f))}}var a=this,e=!1;return{resolve:c(this.resolveTo_),reject:c(this.reject_)}};e.prototype.resolveTo_=function(c){if(c===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof e)this.settleSameAsPromise_(c);else{a:switch(typeof c){case "object":var a=null!=c;break a;case "function":a=!0;break a;default:a=!1}a?this.resolveToNonPromiseObj_(c):this.fulfill_(c)}};e.prototype.resolveToNonPromiseObj_=function(c){var a=
void 0;try{a=c.then}catch(C){this.reject_(C);return}"function"==typeof a?this.settleSameAsThenable_(a,c):this.fulfill_(c)};e.prototype.reject_=function(c){this.settle_(2,c)};e.prototype.fulfill_=function(c){this.settle_(1,c)};e.prototype.settle_=function(c,a){if(0!=this.state_)throw Error("Cannot settle("+c+", "+a|"): Promise already settled in state"+this.state_);this.state_=c;this.result_=a;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,e=0;e<a.length;++e)a[e].call(),a[e]=null;this.onSettledCallbacks_=null}};var y=new f;e.prototype.settleSameAsPromise_=function(a){var c=this.createResolveAndReject_();a.callWhenSettled_(c.resolve,c.reject)};e.prototype.settleSameAsThenable_=function(a,e){var c=this.createResolveAndReject_();try{a.call(e,c.resolve,c.reject)}catch(v){c.reject(v)}};e.prototype.then=function(a,f){function c(a,c){return"function"==typeof a?function(c){try{v(a(c))}catch(D){l(D)}}:c}var v,l,n=new e(function(a,
c){v=a;l=c});this.callWhenSettled_(c(a,v),c(f,l));return n};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,e){function c(){switch(f.state_){case 1:a(f.result_);break;case 2:e(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?y.asyncExecute(c):this.onSettledCallbacks_.push(function(){y.asyncExecute(c)})};e.resolve=l;e.reject=function(a){return new e(function(c,e){e(a)})};e.race=function(a){return new e(function(c,
e){for(var f=$jscomp.makeIterator(a),n=f.next();!n.done;n=f.next())l(n.value).callWhenSettled_(c,e)})};e.all=function(a){var c=$jscomp.makeIterator(a),f=c.next();return f.done?l([]):new e(function(a,e){function n(c){return function(e){v[c]=e;y--;0==y&&a(v)}}var v=[],y=0;do v.push(void 0),y++,l(f.value).callWhenSettled_(n(v.length-1),e),f=c.next();while(!f.done)})};return e},"es6","es3");
$jscomp.executeAsyncGenerator=function(a){function f(f){return a.next(f)}function l(f){return a.throw(f)}return new Promise(function(n,e){function y(a){a.done?n(a.value):Promise.resolve(a.value).then(f,l).then(y,e)}y(a.next())})};
(function(){function a(){var a=/^(.*?)@(.+?):(\d+):(\d+)$/,d=Error().stack.split("\n").slice(2),b=a.exec(d[0]);this.lineNumber=parseInt(b[3],10);this.columnNumber=parseInt(b[4],10);var c=[];d.forEach(function(b){b&&(b=a.exec(b),c.push(b[1]+"@"+b[3]+":"+b[4]))});this.stack=c.join("\n")}function f(m){a.call(this);this.message=m}function l(){return $jscomp.executeAsyncGenerator(function(){function a(b,a,m){for(;;)switch(d){case 0:if(!r){d=1;break}d=-1;return{value:r,done:!0};case 1:return d=-1,{value:new Promise(function(b,
a){a=indexedDB.open("netflix.player");a.onerror=function(a){console.info("open db error",a);b()};a.onsuccess=function(a){a=a.target.result;try{var d=a.transaction(["namedatapairs"]).objectStore("namedatapairs").get("mslstore");d.onerror=function(a){console.info("Error transition");b()};d.onsuccess=function(a){r=a.target.result.data;r.sequencenumber=JSON.parse(atob(r.masterTokenJSON.tokendata)).sequencenumber;b(r)}}catch(t){console.error(t),b()}}}),done:!0};default:return{value:void 0,done:!0}}}var d=
0,b={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();b[Symbol.iterator]=function(){return this};return b}())}function n(a,d){var b={headers:{"Content-Type":"text/plain"},credentials:"include"};Object.keys(d||{}).forEach(function(a){"headers"===a?Object.keys(headers).forEach(function(a){return b.headers[a]=d.headers[a]}):b[a]=d[a]});b.method="POST";return fetch(a,b).then(function(b){return b.text()})}
function e(a){return $jscomp.executeAsyncGenerator(function(){function d(d,g,h){for(;;)switch(b){case 0:return b=1,{value:crypto.subtle.sign({name:"HMAC"},r.hmacKey,J.encode(a)).then(function(b){return new Uint8Array(b)}),done:!1};case 1:if(1!=d){b=2;break}b=-1;throw h;case 2:return m=c=g,b=-1,{value:B.fromByteArray(m),done:!0};default:return{value:void 0,done:!0}}}var b=0,m,c,g={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,void 0,b)},return:function(b){throw Error("Not yet implemented");
}};$jscomp.initSymbolIterator();g[Symbol.iterator]=function(){return this};return g}())}function y(a){var d=new Uint8Array(a);for(--a;0<=a;--a)d[a]=256*Math.random();return d}function c(a){return $jscomp.executeAsyncGenerator(function(){function d(d,h,k){for(;;)switch(b){case 0:return e=y(16),g={keyid:r.esn+"_"+r.sequencenumber,sha256:"AA==",iv:B.fromByteArray(e)},b=1,{value:crypto.subtle.encrypt({name:"AES-CBC",iv:e},r.encryptionKey,J.encode(a)).then(function(b){return new Uint8Array(b)}),done:!1};
case 1:if(1!=d){b=2;break}b=-1;throw k;case 2:return c=m=h,g.ciphertext=B.fromByteArray(c),b=-1,{value:JSON.stringify(g),done:!0};default:return{value:void 0,done:!0}}}var b=0,c,m,g,e,k={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k}())}function N(){return $jscomp.executeAsyncGenerator(function(){function a(a,m,h){for(;;)switch(d){case 0:return d=
1,{value:crypto.subtle.exportKey("spki",r.keyxPublicKey).then(function(b){return new Uint8Array(b)}),done:!1};case 1:if(1!=a){d=2;break}d=-1;throw h;case 2:return b=c=m,d=-1,{value:B.fromByteArray(b),done:!0};default:return{value:void 0,done:!0}}}var d=0,b,c,h={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h}())}function C(a){return $jscomp.executeAsyncGenerator(function(){function d(d,
e,k){for(;;)switch(b){case 0:return m=Math.random()*Math.pow(2,52),h=g={sender:r.esn,capabilities:{languages:[],compressionalgos:a&&(Array.isArray(a)?a:[a])||[]},renewable:!0,messageid:m},b=1,{value:N(),done:!1};case 1:if(1!=d){b=2;break}b=-1;throw k;case 2:c=e;h.keyrequestdata=[{scheme:"ASYMMETRIC_WRAPPED",keydata:{publickey:c,mechanism:"JWK_RSA",keypairid:"rsaKeypairId"}}];if(r.userList&&r.userList.length){d=[];e=$jscomp.makeIterator(r.userList[0].serviceTokenJSONList);for(k=e.next();!k.done;k=
e.next())d.push(k.value);g.useridtoken=r.userList[0].userIdTokenJSON;g.servicetokens=d}g.userauthdata={scheme:"NETFLIXID",authdata:{}};b=-1;return{value:{id:m,header:JSON.stringify(g)},done:!0};default:return{value:void 0,done:!0}}}var b=0,c,h,g,m,e={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e}())}function v(a){return $jscomp.executeAsyncGenerator(function(){function d(d,
w,z){for(;;)switch(b){case 0:return b=1,{value:C(),done:!1};case 1:if(1!=d){b=2;break}b=-1;throw z;case 2:return E=l=w,b=3,{value:c(E.header),done:!1};case 3:if(1!=d){b=4;break}b=-1;throw z;case 4:return F=R=w,K=r.masterTokenJSON,q=window.btoa(F),b=5,{value:e(F),done:!1};case 5:if(1!=d){b=6;break}b=-1;throw z;case 6:return L=w,p={mastertoken:K,headerdata:q,signature:L},x='[{},{"headers":{},"path":"/cbp/cadmium-13","payload":{"data":"'+JSON.stringify(a).replace(/"/g,'\\"')+'"},"query":""}]',t=B.fromByteArray(S.compress(x)),
u={messageid:E.id,data:t,compressionalgo:"LZW",sequencenumber:1,endofmsg:!0},b=7,{value:c(JSON.stringify(u)),done:!1};case 7:if(1!=d){b=8;break}b=-1;throw z;case 8:return k=A=w,f=window.btoa(k),b=9,{value:e(k),done:!1};case 9:if(1!=d){b=10;break}b=-1;throw z;case 10:return g=w,h={payload:f,signature:g},m=JSON.stringify(p)+JSON.stringify(h),b=-1,{value:m,done:!0};default:return{value:void 0,done:!0}}}var b=0,m,h,g,f,k,A,u,t,x,p,L,q,K,F,R,E,l,n={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,
void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();n[Symbol.iterator]=function(){return this};return n}())}function O(a){return $jscomp.executeAsyncGenerator(function(){function d(d,q,k){for(;;)switch(b){case 0:return b=1,{value:l(),done:!1};case 1:if(1!=d){b=2;break}b=-1;throw k;case 2:if(t=x=q){b=3;break}b=-1;throw new f("MSL is undefined!");case 3:return u={method:"manifest",lookupType:"PREPARE",viewableIds:Array.isArray(a)?a:[a],profiles:"playready-h264bpl30-dash playready-h264mpl30-dash heaac-2-dash ddplus-2.0-dash ddplus-5.1-dash dd-5.1-elem dfxp-ls-sdh".split(" "),
drmSystem:"widevine",appId:"14673889385265",sessionParams:{pinCapableClient:!1,uiplaycontext:"null"},sessionId:"14673889385265",trackId:0,flavor:"PRE_FETCH",secureUrls:!0,supportPreviewContent:!0,forceClearStreams:!1,languages:["en-US"],clientVersion:"4.0004.899.011",uiVersion:"akira"},b=4,{value:v(u),done:!1};case 4:if(1!=d){b=5;break}b=-1;throw k;case 5:return e=A=q,b=6,{value:n(T.manifest,{body:e}),done:!1};case 6:if(1!=d){b=7;break}b=-1;throw k;case 7:g=m=q;b=8;d=Q;k=g;for(var z=[],w=k.indexOf('payload":"');~w;)w+=
10,q=k.indexOf('"',w),z.push(k.slice(w,q)),w=k.indexOf('payload":"',q);return{value:d(z),done:!1};case 8:if(1!=d){b=9;break}b=-1;throw k;case 9:return c=h=q,b=-1,{value:c,done:!0};default:return{value:void 0,done:!0}}}var b=0,c,h,g,m,e,A,u,t,x,p={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();p[Symbol.iterator]=function(){return this};return p}())}function Q(a){return $jscomp.executeAsyncGenerator(function(){function d(d,
k,w){for(;;)switch(b){case 0:p="",x=$jscomp.makeIterator(a),t=x.next();case 1:if(t.done){b=3;break}u=t.value;f=JSON.parse(window.atob(u));e=B.toByteArray(f.iv);m=B.toByteArray(f.ciphertext);b=4;return{value:crypto.subtle.decrypt({name:"AES-CBC",iv:e},r.encryptionKey,m).then(function(b){return new Uint8Array(b)}),done:!1};case 4:if(1!=d){b=5;break}b=-1;throw w;case 5:h=g=k,c=JSON.parse((new TextDecoder).decode(h)),p+=window.atob(c.data);case 2:t=x.next();b=1;break;case 3:return p=JSON.parse(p)[1].payload.data,
p=window.atob(p),b=-1,{value:JSON.parse(p),done:!0};default:return{value:void 0,done:!0}}}var b=0,c,h,g,m,e,f,u,t,x,p,l={next:function(b){return d(0,b,void 0)},throw:function(b){return d(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l}())}function H(){var a=document.getElementById("overlay");a&&a.remove();(a=document.getElementById("box"))&&a.remove()}function P(){return $jscomp.executeAsyncGenerator(function(){function a(a,
g,m){for(;;)switch(d){case 0:if(!G){d=1;break}d=-1;return{value:void 0,done:!0};case 1:u=window.location.pathname;A=/^\/watch\/(\d{4,})$/.exec(u);try{if(!A){d=4;break}if(document.getElementById("overlay")){d=5;break}G=!0;f=document.createElement("div");f.id="overlay";document.body.appendChild(f);U.pause();d=7;return{value:O([parseInt(A[1])]),done:!1}}catch(q){k=q;d=2;break}case 7:try{if(1!=a){d=8;break}d=-1;throw m;}catch(q){k=q;d=2;break}case 8:try{h=e=g;c={};M(h.result.viewables[0].audioTracks,
c,"audios");M(h.result.viewables[0].textTracks,c,"subtitles");V(c);G=!1;d=6;break}catch(q){k=q;d=2;break}case 5:try{H()}catch(q){k=q;d=2;break}case 6:case 4:try{d=3;break}catch(q){k=q;d=2;break}case 2:b=k,console.error(":(",b),H();case 3:d=-1;default:return{value:void 0,done:!0}}}var d=0,b,c,h,e,f,k,A,u,t={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(b){throw Error("Not yet implemented");}};$jscomp.initSymbolIterator();t[Symbol.iterator]=function(){return this};
return t}())}function I(a,d){a=""+a;return"0".repeat(Math.max(0,d-a.length))+a}function D(a){var d=function(b,a){b=""+b;return"0".repeat(Math.max(0,a-b.length))+b},b=function(b){var a=Math.round(~~b.substr(-8,7)/1E4);b=~~b.slice(0,-8);var c=b%60,e=Math.floor(b/60%60);return d(Math.floor(b/3600),2)+":"+d(e,2)+":"+d(c,2)+","+d(a,3)},c=(new DOMParser).parseFromString(a,"text/xml"),e=[];a=c.getElementsByTagName("style");for(var g=a.length-1;0<=g;--g){var f=a[g];"italic"===f.getAttribute("tts:fontStyle")&&
e.push(f.getAttribute("xml:id"))}a=function(b,a){return~e.indexOf(a.getAttribute("style"))?"<i>"+b+"</i>":b};c=c.getElementsByTagName("p");g=c.length;f="";for(var k=0,m=1;k<g;){for(var u=c[k++],t=u.childNodes,x=t.length,p="",l=0;l<x;++l){var q=t[l];"br"===q.tagName?p+="\n":q.textContent&&(p="span"===q.tagName?p+a(q.textContent,q):p+q.textContent)}p&&(t=b(u.getAttribute("begin")),x=b(u.getAttribute("end")),p=a(p,u),f+=m++ +"\n"+t+" --\x3e "+x+"\n"+p.replace(/<\/i>\n<i>/g,"\n")+"\n\n")}return f}function W(){var a=
document.querySelector(".video-title > .ellipsize-text");if(a&&1<a.children.length){a=a.children;var d=/(\d+):.+?(\d+)$/.exec(a[1].textContent);return a[0].textContent+".S"+I(d[1],2)+"E"+I(d[2],2)}return a&&a.textContent||""}function V(a){function d(a,b,d){a=a.replace(/(\r)?\n/g,"\r\n");var c=[];switch(d.toUpperCase()){case "ANSI":d=new Uint8Array(a.length);for(var e=0,g=a.length;e<g;++e){var f=a.charCodeAt(e);d[e]=256>f?f:37}c.push(d);break;case "UTF8B":c.push("\ufeff");default:c.push(a)}a=new Blob(c,
{type:"application/octet-stream"});var h=window.URL.createObjectURL(a);a=document.createElement("a");a.style.display="none";a.download=b||"legenda.srt";a.href=h;setTimeout(function(){return window.URL.revokeObjectURL(h)},1E4);document.body.appendChild(a);a.click()}function b(a,b,c,f){var g=document.createElement("span"),h=document.createElement("br");g.className="prefix";g.textContent={"heaac-2-dash":"\u00c1udio 2.0 AAC:","dd-5.1-elem":"\u00c1udio 5.1 AC-3:","ddplus-2.0-dash":"\u00c1udio 2.0 E-AC-3:",
"dd-plus-5.1-dash":"\u00c1udio 5.1 E-AC-3:","dfxp-ls-sdh":"Legenda (dfxp):"}[b];c.appendChild(h);c.appendChild(g);c.appendChild(h.cloneNode());if("dfxp-ls-sdh"===b){var k=document.createDocumentFragment();g=g.cloneNode();g.textContent="Legenda (srt):";k.appendChild(g);k.appendChild(h.cloneNode())}-1===b.indexOf("dfxp")?a.sort(function(a,b){return b.bitrate-a.bitrate}):a.sort(function(a,b){return a.isForced!==b.isForced?!0===a.isForced?1:-1:0});a.forEach(function(a){var b=document.createElement("a");
b.className="quality";if(a.bitrate)b.textContent=a.bitrate+" kbps";else if(b.textContent=a.isForced?"For\u00e7ada":"Normal",!1===a.isImage){var g=document.createElement("a");g.textContent=b.textContent;g.className="quality";g.addEventListener("click",function(b){b.preventDefault();var c=b.target;c.classList.contains("quality")&&(c.classList.remove("quality"),fetch(a.url).then(function(a){return a.text()}).then(function(b){var g=document.getElementById("charsetSub");d(D(b),e+"."+f+"."+(a.isForced?
"forced.":"")+"srt",g&&g.options[g.selectedIndex].value);c.classList.add("quality")}))});k.appendChild(g);k.appendChild(document.createTextNode("\u00a0"))}b.href=a.url;c.appendChild(b);c.appendChild(document.createTextNode("\u00a0"))});k&&2<k.children.length&&(c.appendChild(h.cloneNode()),c.appendChild(h.cloneNode()),c.appendChild(k));c.appendChild(h.cloneNode())}function c(){for(var a=n.length-1;0<=a;--a)n[a].style.display="none";document.querySelector('.select-box-content[data-lang="'+p[p.selectedIndex].value+
'"]').style.display=""}var e=W(),g=document.createElement("select");g.className="selectB";var f=document.createDocumentFragment();Object.keys(a).forEach(function(c){var d=document.createElement("option");d.value=c;d.text=c;"pt-BR"===c&&(d.selected="selected");g.add(d);var e=document.createElement("div");e.setAttribute("data-lang",c);e.className="select-box-content";Object.keys(a[c].audios||{}).map(function(a){return a.replace("ddplus-5","dd-plus-5")}).sort().forEach(function(d){return b(a[c].audios[d.replace("dd-plus-5",
"ddplus-5")],d,e,c)});Object.keys(a[c].subtitles||{}).forEach(function(d){return b(a[c].subtitles[d],d,e,c)});f.appendChild(e)});var k=document.createRange().createContextualFragment('<div id="box">\n\t\t\t<div id="content">\n\t\t\t   <div id="select-box"></div>\n\t\t\t</div>\n\t\t</div>'),m=k.getElementById("select-box"),u=document.createElement("select");u.className="selectB";u.id="charsetSub";var t={UTF8:"UTF-8",UTF8B:"UTF-8 BOM",ANSI:"ANSI"},l=localStorage.getItem("charsetSub");if(null===l||"undefined"===
typeof t[l])l="UTF8",localStorage.setItem("charsetSub",l);Object.keys(t).forEach(function(a){var b=document.createElement("option");a===l&&(b.selected="selected");b.value=a;b.text=t[a];u.add(b)});m.appendChild(g);m.appendChild(u);m.parentNode.insertBefore(f,m.nextSibling);document.body.insertBefore(k,document.body.firstChild);var p=g,n=document.getElementsByClassName("select-box-content");u.addEventListener("change",function(a){a=a.target;localStorage.setItem("charsetSub",a.options[a.selectedIndex].value)});
g.addEventListener("change",c);c()}function M(a,c,b){a.forEach(function(a){a.bcp47&&(c[a.bcp47]||(c[a.bcp47]={}),c[a.bcp47][b]||(c[a.bcp47][b]={}),"ASSISTIVE"!==a.trackType&&a.downloadables&&a.downloadables.forEach(function(d){c[a.bcp47][b][d.contentProfile]||(c[a.bcp47][b][d.contentProfile]=[]);var e=d.urls[d.id.split(";").pop()];c[a.bcp47][b][d.contentProfile].push("audios"===b?{bitrate:d.bitrate,url:e}:{isForced:a.isForced,isImage:d.isImage,url:e})}))})}function X(a){var c=document.head;if(c){var b=
document.createElement("style");b.textContent=a;b.type="text/css";c.appendChild(b);return b}}var T={manifest:"https://www.netflix.com/api/msl/NFCDCH-LX/cadmium/manifest"},B=function(){function a(a,b,d){for(var e=[],g=b;g<d;g+=3)b=(a[g]<<16)+(a[g+1]<<8)+a[g+2],e.push(c[b>>18&63]+c[b>>12&63]+c[b>>6&63]+c[b&63]);return e.join("")}for(var c=[],b=[],e=0;64>e;++e)c[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(e)]=
e;b[45]=62;b[95]=63;return{toByteArray:function(a){var c;var d=c=a.length;if(0<d%4)throw Error("Invalid string. Length must be a multiple of 4");d="="===a[d-2]?2:"="===a[d-1]?1:0;var e=new Uint8Array(3*c/4-d);var f=0<d?c-4:c;var h=0;for(c=0;c<f;c+=4){var m=b[a.charCodeAt(c)]<<18|b[a.charCodeAt(c+1)]<<12|b[a.charCodeAt(c+2)]<<6|b[a.charCodeAt(c+3)];e[h++]=m>>16&255;e[h++]=m>>8&255;e[h++]=m&255}2===d?(m=b[a.charCodeAt(c)]<<2|b[a.charCodeAt(c+1)]>>4,e[h++]=m&255):1===d&&(m=b[a.charCodeAt(c)]<<10|b[a.charCodeAt(c+
1)]<<4|b[a.charCodeAt(c+2)]>>2,e[h++]=m>>8&255,e[h++]=m&255);return e},fromByteArray:function(b){for(var d=b.length,e=d%3,f="",m=[],h=0,l=d-e;h<l;h+=16383)m.push(a(b,h,h+16383>l?l:h+16383));1===e?(b=b[d-1],f+=c[b>>2],f+=c[b<<4&63],f+="=="):2===e&&(b=(b[d-2]<<8)+b[d-1],f+=c[b>>10],f+=c[b>>4&63],f+=c[b<<2&63],f+="=");m.push(f);return m.join("")}}}();f.prototype=Object.create(Error.prototype);f.prototype.constructor=f;f.prototype.name="MslException";f.prototype.toString=function(){return"Type: "+this.name+
"\nMessage: "+this.message+"\nlineNumber: "+this.lineNumber+"\ncolumnNumber: "+this.columnNumber+"\n\nStack:\n"+this.stack};var r,S=function(){function a(a,b){var c=b||a.length;return a.reduce(function(a,b,d){return d<c?a+String.fromCharCode(b):a},"")}for(var c=Object.create(null),b=0;256>b;++b)c[String.fromCharCode(b)]=b;var e=new TextEncoder;return{compress:function(b){function d(a,b){for(;0<b;){if(n>=f.length)return!1;var c=a;if(b>p)c>>>=b-p,f[n]|=c&255,b-=p,p=8,++n;else{c<<=p-b;c&=255;c>>>=8-
p;f[n]|=c&255;p-=b;0===p&&(p=8,++n);break}}return!0}b=e.encode(b);var f=new Uint8Array(b.length),k=Object.create(null),m=b.length,h=[];for(l in c)k[l]=c[l];var l=256;var n=0,p;var r=p=8;for(var q=0;q<m;++q){var v=b[q];h.push(v);var w=a(h);if(!k[w]){h=a(h,h.length-1);if(!d(k[h],r))return null;0!==l>>r&&++r;k[w]=l++;h=[v]}}return 0<h.length&&!d(k[a(h)],r)?null:f.subarray(0,8>p?n+1:n)}}}(),J=new TextEncoder,U=function(){return{pause:function(){setTimeout(function(){var a=document.querySelector(".button-nfplayerPause");
a&&a.click()},2E3)}}}(),G=!1;window.addEventListener("DOMContentLoaded",function(){X("#overlay {\n\t\t\tz-index: 10;\n\t\t\tposition: absolute;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\twidth: 100%;\n\t\t\theight: 100%;\n\t\t\tbackground: #000;\n\t\t\topacity: 0.8;\n\t\t}\n\n\t\t#box {\n\t\t\tborder: 2px solid #edebd7;\n\t\t\tbox-shadow: 1px 1px 1px #6e675f;\n\t\t\tbackground: #423e37;\n\t\t\tz-index: 11;\n\t\t\tcolor: #FFF;\n\t\t\tpadding: 0.5em;\n\t    \tfont-size: 16px;\n\t    \tfont-family: 'Roboto', sans-serif;\n\t    \tfont-weight: bold;\n\t    \tline-height: 1.2em;\n\t\t\tposition: absolute;\n\t    \tmargin: 0 auto;\n\t    \ttop: 50%;\n\t\t\tleft: 50%;\n\t\t\tmargin-left: -150px;\n\t\t\tmargin-top: -150px;\n\t\t\twidth: 400px;\n\t\t\theight: 350px;\n\t\t}\n\n\t\t.selectB {\n\t\t\tcolor: #595757;\n\t\t\twidth: 120px;\n\t\t\tpadding: 0.3em;\n\t\t\tmargin: 0.3em;\n\t\t}\n\n\t\t#content {\n\t\t\ttext-align: center;\n\t\t\theight: 300px;\n\t\t}\n\n\t\t.prefix {\n\t\t\tcolor: #a19c90;\n\t\t}\n\t\t.quality {\n\t\t\ttext-decoration: none;\n\t\t\tcursor: pointer;\n\t\t\tcolor: #edebd7;\n\t\t}\n\n\t\t.quality:hover {\n\t\t\tcolor: #81a094;\n\t\t}");
document.body.addEventListener("keydown",function(a){document.getElementById("overlay")&&a.stopPropagation();a.altKey&&a.shiftKey&&78===a.which&&P()},!0)})})();
/* jshint ignore:end */